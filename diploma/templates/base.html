{% load static %}
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>{% if page_title %}{{ page_title }}{% endif %}</title>

    {% block css %}
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
        <link rel="stylesheet" href="{% static 'css/styles.css' %}">
    {% endblock %}
<script type='text/javascript'>
   function renderShopCard(shop_id, form) {
        alert("renderShopCard(" + shop_id + "); " + form);
        var value = "";
        for (shop in form.info) {
            alert("in for " + shop);
            if ((shop.shop_id == shop_id) || (shop.shop_id == "all")) {
                alert("in if");
                value = value + "<div class=\"shop_card\">";
                value = value + "Магазин : {{shop.shop}}";
                value = value + "Цена <b>{{shop.price}}</b>";
                value = value + "Цена до <b>{{shop.price_rrc}}</b>";
                value = value + "Остаток <b>{{shop.quantity}}</b>";
                value += "<button type=\"submit\">В корзину</button>";
                value += "</div>";
                alert(value);
            }
       }
       return value;
   }
	function handleSelectChange(form_id, form) {
        var shop_id = document.getElementById("select" + form_id).value;
        var rnddd = renderShopCard(shop_id);
        alert(rnddd);
        document.getElementById("product_description_" + form_id).innerHTML = renderShopCard(shop_id, form);
    }
</script>

</head>
<body>
    {% if page_title %}
        <div class="container">
            <h1>{{ page_title }}</h1>
        </div>
    {% endif %}

    <div class="container my-4">
        {% if not user.is_authenticated %}
            <a href="/user/login" >Вход</a> | <a href="/user/signup">Регистрация</a> | <a href="user/password_change">Сбросить пароль</a>
        {% else %}
        Привет, {{ user.username }} | <a href="{% url 'homepage'%}" >Главная </a> | <a href="/user/details" >Детали Аккаунта</a> |  <a href="{% url 'logout' %}">Выйти</a>
        | <a href="user/get_token">Узнать Токен</a> | <a href="user/password_change">Сбросить пароль</a> | <a href="/shops">Данные магазина</a>
        {% endif %}
    </div>

    {% block content %}{% endblock %}

    {% block js %}
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
        <script src="{% static 'js/scripts.js' %}"></script>
    {% endblock %}
</body>
</html>